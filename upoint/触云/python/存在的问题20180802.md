## 脚本中的问题汇总
#### pandas使用问题
#### 临时数据缓存问题
#### 操作ES时,未使用[Elasticsearch-Hadoop](https://www.elastic.co/products/hadoop)
#### 操作mongo时,未使用[MongoDB Connector for Apache Spark](https://www.mongodb.com/products/spark-connector)
#### 结构更改,考虑读取数据并根据mac去重后，使用foreach完成后续的操作
#### 抽样存入ES的问题
#### 分成v1和v2两个脚本的问题
#### 考虑在进行处理时可能的数据大小,以更好地调节参数
#### 同一个数据进行两次同一个操作
#### 对原始数据进行异常判断时,有一点问题
#### 按指定的概率产生error_index
#### es是否有必要的问题
#### 运行速度的问题

## 其他问题

1. 缺少代码的管理工具,直接在服务器上修改代码,容易丢失历史代码或引起其他错误
2. 大量注释掉的代码,没有说明,如果是无用的应删掉,其他原因注释的需写明原因
3. 没有很好的复用代码
4. 没有测试报告,应该是没有进行过测试的
5. 缺少日志系统
6. 缺少检测、清理和备份功能,检测脚本是否在正常运行或运行结果是否正确,清理日志或者历史数据，重要数据定时备份

## 脚本问题详细
#### common.py
* 自定义的toPandas存在性能问题

#### ftp_download.py

#### import2es.py
* 这里将mac_info存储在es，只是为后续操作做的一次数据缓存，是否考虑使用其他方式（如redis）进行数据缓存

#### parse_01.py
* hdfs中大量的小文件,读取比较耗时
* Event_Data中的数据并没有做任何处理,被直接忽略
* 在spark DataFrame或spark sql能进行计算的情况下， 建议尽量不使用pandas
* 对mongo的操作，使用的是pymongo。建议改为使用[MongoDB Connector for Apache Spark](https://www.mongodb.com/products/spark-connector)
* 对elasticsearch的操作，建议使用[Elasticsearch-Hadoop](https://www.elastic.co/products/hadoop)
* 考虑读取数据并根据mac去重后，使用foreach完成后续的操作

#### parse_04.py
* WIFI_INFO信息只做了抽样，取了0.001的数据并存入，没有后续的操作使用到这个WIFI_INFO，不知这里是否需要存入elasticsearch
* 这里使用hdfs作为中转，可以考虑是否使用其他的形式

#### parse_05_v1.py
* 没必要分两个脚本分别处理v1和v2的数据，这样会需要对hdfs中0xff05的数据读取两次
* v1的数据很少，没必要分成800份存入hdfs
* 这里使用hdfs作为中转，可以考虑是否使用其他的形式

#### parse_05_v2.py
* 在分析异常时，对CPUMEM_INFO信息的判断逻辑有一点问题
* 在对detail的处理时候有误
* 这里使用hdfs作为中转，可以考虑是否使用其他的形式
* 按0.01抽样，按指定的概率产生error_index，合并后存入type05，不太明白这个操作的意义，而且type05的数据在后续操作中没有用到

#### parse_06.py
* 语音VoIP异常的判断有误，detail的处理不统一
* 这里使用hdfs作为中转，可以考虑是否使用其他的形式
* 抽样，按指定的概率产生error_index，合并后存入type06，不太明白这个操作的意义，而且type06的数据在后续操作中没有用到
* 存入type06的操作的相关操作报错，已注释掉

#### sum_normal_py.py

#### deal_error_v1.py

#### deal_error_v2.py
* processerror的计算可能是错的,`df_parse5_pivot['processerror'] = df_parse5_pivot.processerror+df_parse5_pivot.conerror+df_parse5_pivot.pontemerror+df_parse5_pivot.wifierror`
* 统计每个mac的每种异常的次数,这个操作在sum_normal中也进行过

#### sum_ex_day_v1.py
* 部分历史数据不满足相关关系

#### sum_ex_day_v2.py
* 与sum_ex_day_v1.py有大量代码重复

#### sum_ex_cls_day_v1.py

#### sum_ex_cls_day_v2.py

#### sum_ex_range_v1.py

#### sum_ex_range_v2.py

#### sum_ex_cls_range_v1.py

#### sum_ex_cls_range_v1.py


